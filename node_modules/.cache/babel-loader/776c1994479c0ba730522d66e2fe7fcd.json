{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Documents\\\\reactlinelogin\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport LoginForm from './LoginForm';\nimport Home from './Home';\nimport ProductDetail from './ProductDetail';\nimport './App.css';\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.Onupdate = () => {\n      this.setState({\n        currentUser: true\n      });\n    };\n\n    this.state = {\n      userID: '',\n      name: '',\n      currentUser: null,\n      picture: ''\n    };\n    this.Onupdate = this.Onupdate.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.state.currentUser == null) {// location.href = \"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=1654986755&redirect_uri=http://localhost:3000/lineAPI&state=12345abcde&scope=profile%20openid&nonce=09876xyz\";\n      // window.location.href = \"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=1654986755&redirect_uri=http://localhost:3000/lineAPI&state=12345abcde&scope=profile%20openid&nonce=09876xyz\";\n    }\n\n    let search = window.location.search;\n    let params = new URLSearchParams(search);\n    let code = params.get('code');\n    console.log(code);\n\n    if (code != undefined || code != null) {\n      var request = require('request');\n\n      var options = {\n        'method': 'POST',\n        'url': 'https://api.line.me/oauth2/v2.1/token',\n        'headers': {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        form: {\n          'grant_type': 'authorization_code',\n          'code': code,\n          'redirect_uri': 'http://localhost:3000/lineAPI',\n          'client_id': '1654986755',\n          'client_secret': 'bdc92e6f36cc32f1f48f91c0d1ca2f45'\n        }\n      };\n      request(options, function (error, response) {\n        if (error) throw new Error(error);\n        let data = JSON.parse(response.body);\n        console.log(data.id_token);\n        var options2 = {\n          'method': 'POST',\n          'url': 'https://api.line.me/oauth2/v2.1/verify',\n          'headers': {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          form: {\n            'id_token': data.id_token,\n            'client_id': '1654986755'\n          }\n        };\n        request(options2, function (error, response2) {\n          if (error) throw new Error(error);\n          let data2 = JSON.parse(response2.body);\n          console.log(data2);\n\n          if (data2.error == 'invalid_request') {\n            window.location.href = \"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=1654986755&redirect_uri=http://localhost:3000/lineAPI&state=12345abcde&scope=profile%20openid&nonce=09876xyz\";\n          } else {\n            this.Onupdate(); // var options3 = {\n            //     'method': 'POST',\n            //     'url': 'http://locahost/api/login.php',\n            //     'headers': {\n            //       'Content-Type': 'application/x-www-form-urlencoded'\n            //     },\n            //     form:data2\n            //   };\n            //   request(options3, function (error, response3) {\n            //     if (error) throw new Error(error);\n            //     let data3 = JSON.parse(response3);\n            //     console.log(data3);\n            //   });\n          }\n        }.bind(this));\n      }.bind(this));\n    }\n  }\n\n  render() {\n    console.log(this.state.currentUser);\n\n    if (this.state.currentUser == null) {\n      return /*#__PURE__*/React.createElement(Router, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        component: LoginForm,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(Route, {\n        path: \"/Product\",\n        component: LoginForm,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }\n      })));\n    } else {\n      return /*#__PURE__*/React.createElement(Router, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Route, {\n        exact: true,\n        path: \"/\",\n        component: Home,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(Route, {\n        path: \"/Product\",\n        component: ProductDetail,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }\n      })));\n    }\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/Admin/Documents/reactlinelogin/src/App.js"],"names":["React","Component","LoginForm","Home","ProductDetail","BrowserRouter","Router","Route","Link","App","constructor","props","Onupdate","setState","currentUser","state","userID","name","picture","bind","componentDidMount","search","window","location","params","URLSearchParams","code","get","console","log","undefined","request","require","options","form","error","response","Error","data","JSON","parse","body","id_token","options2","response2","data2","href","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport LoginForm from './LoginForm'\nimport Home from './Home'\nimport ProductDetail from './ProductDetail'\nimport './App.css'\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom';\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      userID: '',\n      name: '',\n      currentUser: null,\n      picture: ''\n    }\n    this.Onupdate = this.Onupdate.bind(this);\n  }\n  componentDidMount(){\n    if(this.state.currentUser == null){\n      // location.href = \"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=1654986755&redirect_uri=http://localhost:3000/lineAPI&state=12345abcde&scope=profile%20openid&nonce=09876xyz\";\n      // window.location.href = \"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=1654986755&redirect_uri=http://localhost:3000/lineAPI&state=12345abcde&scope=profile%20openid&nonce=09876xyz\";\n   \n    }\n\n    let search = window.location.search;\n    let params = new URLSearchParams(search);\n    let code = params.get('code');\n    \n       console.log(code);\n       if(code != undefined  || code != null){\n        var request = require('request');\n        var options = {\n          'method': 'POST',\n          'url': 'https://api.line.me/oauth2/v2.1/token',\n          'headers': {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          form: {\n            'grant_type': 'authorization_code',\n            'code':code,\n            'redirect_uri': 'http://localhost:3000/lineAPI',\n            'client_id': '1654986755',\n            'client_secret': 'bdc92e6f36cc32f1f48f91c0d1ca2f45'\n          }\n        };\n        request(options, function (error, response) {\n          if (error) throw new Error(error);\n    \n          let data = JSON.parse(response.body);\n          console.log(data.id_token);\n        var options2 = {\n            'method': 'POST',\n            'url': 'https://api.line.me/oauth2/v2.1/verify',\n            'headers': {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            },\n            form: {\n              'id_token': data.id_token,\n              'client_id': '1654986755'\n            }\n          };\n          request(options2, function (error, response2) {\n            if (error) throw new Error(error);\n     \n            let data2 = JSON.parse(response2.body);\n            console.log(data2);\n            if(data2.error == 'invalid_request'){\n             window.location.href = \"https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=1654986755&redirect_uri=http://localhost:3000/lineAPI&state=12345abcde&scope=profile%20openid&nonce=09876xyz\";\n            }else{\n              this.Onupdate();\n                              // var options3 = {\n                //     'method': 'POST',\n                //     'url': 'http://locahost/api/login.php',\n                //     'headers': {\n                //       'Content-Type': 'application/x-www-form-urlencoded'\n                //     },\n                //     form:data2\n                //   };\n                //   request(options3, function (error, response3) {\n                //     if (error) throw new Error(error);\n             \n                //     let data3 = JSON.parse(response3);\n                //     console.log(data3);\n                \n                //   });\n            }\n          }.bind(this));\n        }.bind(this));\n        \n     \n       }\n  }\n  Onupdate = ()=>{\n    this.setState({\n      currentUser: true\n    })\n  }\n  render() {\n  \n    console.log(this.state.currentUser);\n    if(this.state.currentUser == null){\n      return(\n        <Router>\n        {/* Router component can have only 1 child. We'll use a simple\n          div element for this example. */}\n        <div>\n\n          <Route exact path=\"/\" component={LoginForm} />\n          <Route path=\"/Product\" component={LoginForm} />\n        </div>\n      </Router>\n      )\n    }else{\n      return(\n        <Router>\n        {/* Router component can have only 1 child. We'll use a simple\n          div element for this example. */}\n        <div>\n\n          <Route exact path=\"/\" component={Home} />\n          <Route path=\"/Product\" component={ProductDetail} />\n        </div>\n      </Router>\n      )\n    }\n  \n  }\n\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}